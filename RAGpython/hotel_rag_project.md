# Приложение: Помощник по подбору отеля (RAG)

**Краткое описание**

Приложение помогает туристам подбирать отели на основе их предпочтений (место, бюджет, звезды, удобства). Для повышения качества ответов используется архитектура RAG (Retrieval-Augmented Generation): локальная база векторных эмбедингов + LLM (чат-модель). При запросе пользователя система ищет релевантные фрагменты (описания отелей, отзывы, советы) и передаёт их в контекст LLM для генерации информированного ответа.

## Основная идея и концепции

- Собрать маленький, но репрезентативный набор данных отелей (метаданные + тексты описаний + URL + удобства и отзывы).
- Индексировать тексты в векторную базу (Weaviate / Milvus / Pinecone-совместимая) — мы используем Weaviate в docker-compose как пример.
- Для эмбедингов используется современная модель (например, OpenAI embeddings `text-embedding-3-small/large`). Размер векторов — зависит от модели (1536/3072), но код абстрагирован.
- На этапе запроса: преобразуем пользовательский ввод в вектор, ищем N самых релевантных документов, формируем промпт с контекстом и отправляем в LLM.

## Детали дизайна

1. Источник данных
   - Собранные JSON-файлы с событиями/записями отелей (включая 50 примеров).
   - Каждый документ содержит: `id`, `name`, `city`, `country`, `stars`, `price_per_night`, `amenities`, `description`, `url`, `latitude`, `longitude`.

2. Хранилище векторов
   - Weaviate (docker) — прост в разворачивании и имеет Python клиент.
   - Векторное поле: `embedding` (тип: float[]), а также обычные метаданные для фильтрации.

3. Поток данных (ETL)
   - `ingest_weaviate.py`: читает JSON, вычисляет эмбединги, загружает записи в Weaviate.
   - Используется batch-инсерты для скорости.

4. Компоненты приложения
   - CLI / Streamlit UI (`app_streamlit.py`) для быстрого прототипа.
   - `embeddings_client.py` — обёртка для получения эмбедингов (OpenAI API ключ нужен).
   - `search_and_answer.py` — пример LLM-клиента: выполняет поиск по векторам, формирует контекст и вызывает LLM (OpenAI ChatCompletion).

## Технические характеристики системы

- Язык: Python 3.10+
- Веб-интерфейс: Streamlit (быстрый прототип)
- База векторов: Weaviate (docker-compose, standalone)
- Клиент для встраиваний: OpenAI Embeddings API (или любой другой совместимый поставщик)
- LLM: OpenAI Chat Completions (или любой другой совместимый)

## Требования к окружению

- Docker & Docker Compose (если запускаете Weaviate через Docker)
- Python 3.10+
- Установленные зависимости (`requirements.txt` прилагается)
- Переменные окружения:
  - `OPENAI_API_KEY` — ключ OpenAI (или другой провайдер)
  - `WEAVIATE_URL` — URL локального Weaviate (например, `http://localhost:8080`)

## Ограничения и соображения безопасности

- API-ключи не включены в репозиторий — указывайте их в .env или переменных окружения.
- Лимиты модели эмбедингов и стоимость — следите за использованием.
- Weaviate в Docker открыт на локальной машине; если делаете публичный развёртывание, настройте аутентификацию и брандмауэр.

## Концепция набора данных

1. **Типы записей:** отели, мини-отели, хостелы, апартаменты.
2. **Поля:**
   - `id` (строка)
   - `name` (строка)
   - `city`, `country` (строки)
   - `stars` (int)
   - `price_per_night` (float)
   - `amenities` (лист строк)
   - `description` (длинный текст для встраивания)
   - `url` (строка)
   - `latitude`, `longitude` (float)

3. **Аннотации:** для части записей добавлены короткие отзывы / советы (в поле `description` или отдельном поле `note`) для создания контекста RAG.

## Файлы, приложенные к проекту

- `project/hotel_rag_project.md` (этот файл)
- `data/dataset_hotels.json` — 50 записей (готово для импорта)
- `docker-compose.yml` — конфигурация Weaviate
- `ingest_weaviate.py` — скрипт для загрузки данных в Weaviate
- `embeddings_client.py` — обёртка для эмбедингов
- `app_streamlit.py` — Streamlit UI клиент
- `search_and_answer.py` — интеграция поиска + LLM
- `requirements.txt`
- `README_RUN.md` — пошаговая инструкция запуска локально

---

*Готов предоставить все сопутствующие файлы (JSON, скрипты, docker-compose). Я также подготовлю примерные скрипты и dataset в файловой системе — скажите, если хотите, чтобы я сразу записал их и дал ссылки для скачивания.*

